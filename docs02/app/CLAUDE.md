# CLAUDE.md

Claude Code (claude.ai/code)가 Sweet Puzzle (캔디소다) 프로젝트에서 작업할 때 참고할 가이드입니다.

## 📋 프로젝트 헌법 및 개발 원칙

-   **전체 프로젝트의 뼈대 및 맥락 제공:** 이 문서는 Sweet Puzzle 캔디 크러시 스타일 모바일 퍼즐 게임 프로젝트의 목표, 기능, 기술 스택 등 모든 것을 정의합니다.
-   **모든 개발/설계/코드 작성의 기준점:** 새로운 기능을 추가하거나 기존 코드를 수정할 때, 이 문서를 최우선으로 참고해야 합니다.
-   **LLM 및 개발자가 반드시 준수해야 할 규칙 명시:** 아래 규칙들은 프로젝트의 일관성과 품질을 유지하기 위한 핵심 약속입니다.
    -   **명시적인 의도(주석):** 모든 주요 함수/모듈 상단에는 `[의도] ...`와 `[책임] ...` 형식으로 주석을 작성하여 의도와 책임을 명확히 해야 합니다.
    -   **헌법 준수:** 새로운 기능 개발 시 본 헌법의 설계와 원칙을 반드시 준수해야 합니다.
    -   **불확실성 명시:** 불확실하거나 논의가 필요한 부분은 `[불확실한 부분] ...` 또는 `TODO`, `FIXME` 등으로 명시하고 피드백을 요청해야 합니다.
    -   **설계 철학 준수:** Claude, ChatGPT 등 LLM은 이 문서의 설계 철학(UI/UX 가이드라인, 기술 스택 등)에서 벗어나는 코드를 생성해서는 안 됩니다.
    -   **문서 수정 원칙:** 문서 수정이나 통합 시에는 해당 항목을 업데이트하거나 새로운 항목을 추가하되, **기존 내용을 삭제해야 할 경우에는 반드시 사전에 상의 후 반영합니다.**
-   **보안 원칙:**
    -   API 키 및 민감정보는 반드시 서버사이드에서 관리, 클라이언트 노출 금지
    -   사용자 게임 데이터 및 프로필 정보는 암호화하여 저장
    -   웹 기반 게임 실행 시 보안 정책 준수 필수
-   **문서 동기화: 살아있는 기록으로서의 문서 구조**
    -   **`CLAUDE.md` (헌법 & 청사진):** 이 문서는 프로젝트의 '왜'와 '무엇'을 정의합니다. 시스템의 비전, 아키텍처, 핵심 원칙 등은 항상 이 문서를 기준으로 하며, 큰 방향성의 변경이 있을 때만 수정됩니다. 모든 참여자(기획, 개발, 디자인, AI)는 의사결정 시 이 문서를 최우선 기준으로 삼아야 합니다.
    -   **테스트 자동화 문서:** 개발 환경 구축, 테스트 실행, 특정 기능의 구체적인 구현 과정, 문제 해결 기록 등 모든 기술적 세부사항과 이력을 기록합니다.
-   **현재 상태와 목표:** 현재 상태는 독립적인 테스트 환경을 구축하고 퍼즐 시스템 구현을 시작하는 단계입니다. GitHub 저장소 https://github.com/lausiv7/candysoda 를 통해 진행 상황을 관리하며, 최종 목표는 테스트 자동화 기반의 안정적인 Sweet Puzzle 캔디 크러시 스타일 모바일 퍼즐 게임을 HTML5/JavaScript로 구현하는 것입니다.

## 프로젝트 개요

Sweet Puzzle은 캔디 크러시 스타일의 모바일 퍼즐 게임 프로젝트입니다. 3매치 퍼즐 메커니즘과 소셜 기능을 결합한 캐주얼 게임으로, 현재 설계 완료 후 구현 단계입니다.

## 프로젝트 구조

현재 설계 문서와 구현계획이 포함되어 있습니다:
- `docs02/01-Game-Design.md` - Sweet Puzzle 종합 게임 기획서
- `docs02/02-TRD.md` - 기술 요구사항 문서
- `docs02/03-Puzzle-System-Design.md` - 퍼즐 시스템 설계
- `docs02/03-Puzzle-System-Design-구현계획.md` - 퍼즐 시스템 구현계획
- `docs02/04-Progression-System-Design.md` - 진행 시스템 설계
- `docs02/04-Progression-System-Design-구현계획.md` - 진행 시스템 구현계획
- `docs02/05-Social-System-Design.md` - 소셜 시스템 설계
- `docs02/05-Social-System-Design-구현계획.md` - 소셜 시스템 구현계획
- `docs02/06-UI-UX-System-Design.md` - UI/UX 시스템 설계
- `docs02/06-UI-UX-System-Design-구현계획.md` - UI/UX 시스템 구현계획
- `docs02/07-Analytics-System-Design.md` - 분석 시스템 설계
- `docs02/07-Analytics-System-Design-구현계획.md` - 분석 시스템 구현계획
- `docs02/08-Monetization-System-Design.md` - 수익화 시스템 설계
- `docs02/08-Monetization-System-Design-구현계획.md` - 수익화 시스템 구현계획

## 개발 컨텍스트

Sweet Puzzle 캔디 크러시 스타일 모바일 퍼즐 게임의 **설계 완료 및 구현 시작 저장소**입니다:

### 게임 컨셉
- **플랫폼**: 모바일 웹 (PWA 지원)
- **장르**: 3매치 퍼즐 게임
- **기술 스택**: HTML5/CSS3/JavaScript + Node.js/Firebase
- **타겟**: 캐주얼 게이머 (여성 25-45세 중심)
- **핵심 루프**: 퍼즐 해결 → 진행 → 보상 → 소셜 상호작용

### 주요 시스템 (설계 완료)
- **퍼즐 시스템**: 3매치 매칭, 특수 블록, 파이어볼/폭탄 시스템
- **진행 시스템**: 500+ 레벨, 별점 시스템, 일일 도전
- **소셜 시스템**: 친구 연동, 라이프 주고받기, 리더보드
- **수익화 시스템**: 아이템 상점, 무제한 라이프, 광고 시청
- **분석 시스템**: 플레이어 행동 추적, A/B 테스트, 리텐션 분석

### 테스트 자동화 통합 계획
`../test-auto-repair/` 시스템을 기반으로 한 개발 및 운영 자동화:
- **개발 환경 구축**: Docker 기반 개발 환경 + 자동 테스트
- **테스트 리페어 루프**: 게임 기능 테스트 실패 시 자동 수정
- **점진적 개선**: 03 퍼즐 시스템부터 단계별 구현 및 테스트
- **통합 테스트**: 전체 게임 시스템 통합 후 자동 테스트 실행
- **운영 모니터링**: 실시간 게임 상태 모니터링 및 자동 대응

## 개발 참고사항

- **현재 단계**: 설계 완료, 구현 시작 단계
- **구현 우선순위**: 03 퍼즐 시스템 → 04 진행 시스템 → 06 UI/UX → 기타 시스템
- **테스트 기반 개발**: 각 시스템 구현 시 자동 테스트 병행 작성
- **모바일 우선**: 터치 인터페이스와 반응형 디자인 중심
- **성능 최적화**: 60FPS 유지, 메모리 사용량 최적화

## 저장소 작업 시 주의사항

이 프로젝트 작업 시:
1. `docs02/01-Game-Design.md`에서 전체 게임 컨셉과 방향성 확인
2. `docs02/02-TRD.md`에서 기술적 요구사항과 아키텍처 이해
3. 각 시스템별 설계 문서와 구현계획 문서를 쌍으로 참조
4. 테스트 자동화 시스템(`../test-auto-repair/`)과 연동하여 개발
5. 모바일 플랫폼 특화 UX 고려사항 우선 반영

## 테스트 자동화 및 개발 환경

### 독립적인 테스트 환경 구축
Sweet Puzzle 프로젝트는 `docs02/app/` 디렉토리 내에 독립적인 테스트 자동화 환경을 구축합니다:
- **개발 환경**: `app/dev-environment/` - Docker 기반 개발 서버 설정
- **테스트 설정**: `app/test-setup/` - 프로젝트 특화 테스트 설정
- **리포트 생성**: `app/reports/` - 개발 진행 상황과 테스트 결과
- **자동화 스크립트**: `app/scripts/` - 개발 프로세스 자동화

### 테스트 리페어 루프 시스템
상위 `../../test-auto-repair/` 시스템의 핵심 로직을 Sweet Puzzle 게임 개발에 맞게 적용:

#### 21. 테스트 리페어 루프 설계 적용
- **3가지 테스트 모드**: Semi-Auto, Auto, Interactive
- **Diff 기반 수정 제안**: Git diff 형태로 변경사항 시각화
- **지능형 실패 분석**: 퍼즐 게임 특화 실패 패턴 감지
- **자동 문서화**: 모든 수정 과정 자동 기록

#### 22. 테스트 루프 운영 가이드 적용
- **게임 환경 구축**: Docker 기반 개발 환경 설정
- **단계별 테스트**: 퍼즐 시스템부터 순차적 구현 및 검증
- **시각적 테스트**: 게임 UI 스크린샷 기반 회귀 테스트
- **성능 모니터링**: 60FPS 유지, 메모리 사용량 측정

#### 개발 환경 구축 절차
```bash
# 1. Sweet Puzzle 개발 환경 설정
cd docs02/app
./setup-sweet-puzzle-dev.sh

# 2. 퍼즐 시스템 구현 시작
./start-puzzle-system-dev.sh

# 3. 테스트 리페어 루프 활성화
./enable-test-repair-loop.sh puzzle-system

# 4. 실시간 개발 모니터링
./monitor-game-development.sh
```

### 점진적 개선 계획

#### Phase 1: 핵심 퍼즐 시스템 (현재 목표)
- **03 퍼즐 시스템 구현**: 3매치 로직, 블록 시스템, 특수 효과
- **자동 테스트 구축**: 퍼즐 매칭 로직 단위 테스트
- **시각적 검증**: 게임 화면 렌더링 테스트

#### Phase 2: 기본 게임 루프
- **04 진행 시스템 구현**: 레벨 시스템, 별점, 스코어
- **06 UI/UX 구현**: 게임 인터페이스, 애니메이션
- **통합 테스트**: 전체 게임 플로우 검증

#### Phase 3: 고급 기능
- **05 소셜 시스템**: 친구 기능, 리더보드
- **07 분석 시스템**: 플레이어 데이터 수집
- **08 수익화 시스템**: 상점, 광고 연동

### 범용성 및 모듈성 설계

#### 24. 범용 테스트 리페어 루프 MCP 서버 지향
- **모듈화된 게임 컴포넌트**: 다른 퍼즐 게임에서도 재사용 가능
- **설정 가능한 테스트 규칙**: 게임 타입별 커스텀 테스트 로직
- **플러그인 아키텍처**: 새로운 게임 장르 지원 확장
- **표준화된 게임 API**: 다양한 캐주얼 게임 개발에 활용

이 접근 방식을 통해 Sweet Puzzle은 단순한 게임 개발을 넘어 게임 개발 자동화 플랫폼의 시범 사례가 될 것입니다.

## 23. 수동 테스트 방법 정리 (예정)

03 퍼즐 시스템 구현계획까지 단계별 구현이 완료되면, 다음 항목들에 대한 수동 테스트 방법을 정리할 예정입니다:

### 퍼즐 게임 특화 테스트 항목
- **매칭 로직 검증**: 3매치, 4매치, 5매치 시나리오별 테스트
- **특수 블록 생성**: 파이어볼, 폭탄, 레인보우 블록 생성 조건 테스트
- **콤보 시스템**: 연쇄 매칭과 점수 계산 검증
- **레벨 클리어 조건**: 목표 달성 로직과 별점 시스템 테스트
- **UI 반응성**: 터치 입력, 드래그 앤 드롭, 애니메이션 품질

### 크로스 플랫폼 테스트
- **다양한 디바이스**: 스마트폰, 태블릿, 데스크톱 브라우저
- **성능 테스트**: 저사양 기기에서의 프레임률과 반응속도
- **네트워크 조건**: 오프라인 플레이, 불안정한 연결 상황

이러한 수동 테스트 가이드는 자동 테스트로 커버하기 어려운 사용자 경험 품질을 보장하는 데 중요한 역할을 할 것입니다.